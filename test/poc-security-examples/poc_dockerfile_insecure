# INTENTIONAL DOCKERFILE SECURITY ISSUES FOR POC TESTING
# This file contains intentional security vulnerabilities to validate
# CodeRabbit security scanning configuration (JIRA: RHOAIENG-38196)
#
# DO NOT MERGE TO PRODUCTION - PoC VALIDATION ONLY

# SECURITY ISSUE 1: Using 'latest' tag (unpinned base image)
# Expected: semgrep rule 'dockerfile-latest-tag' should trigger
FROM golang:latest

# SECURITY ISSUE 2: Hardcoded secret in ENV
# Expected: semgrep rule 'dockerfile-secret-in-env' should trigger
ENV DATABASE_PASSWORD=SuperSecret123!
ENV API_TOKEN=token_EXAMPLE_not_real_1234567890abcd

# Install dependencies as root
RUN apt-get update && apt-get install -y \
    curl \
    wget \
    vim

WORKDIR /app

COPY . .

# Build application
RUN go build -o myapp .

# SECURITY ISSUE 3: Running as root user (no USER directive)
# Expected: Hadolint should warn about missing USER directive

# Expose port
EXPOSE 8080

# Run application as root
CMD ["./myapp"]
