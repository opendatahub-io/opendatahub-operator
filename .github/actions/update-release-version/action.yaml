name: "Update release versions"
description: "Update versions in the manifests/makefile"
inputs:
  version:
    description: 'The release version'
    required: true
runs:
  using: "composite"
  steps:
    - name: Update versions in relevant files
      shell: bash
      run: ./.github/scripts/update-versions.sh ${{ inputs.version }}
    - name: Run make manifests & bundle
      shell: bash
      run: make manifests bundle
    - name: Clean up
      shell: bash
      run: |
        sed -i -e "s|image: quay.io/opendatahub/opendatahub-operator:latest.*|image: REPLACE_IMAGE:latest|g" bundle/manifests/opendatahub-operator.clusterserviceversion.yaml
        rm ./config/manager/kustomization.yaml
