checks:
  # if doNotAutoAddDefaults is true, default checks are not automatically added.
  doNotAutoAddDefaults: true

  # addAllBuiltIn, if set, adds all built-in checks. This allows users to
  # explicitly opt-out of checks that are not relevant using Exclude.
  # Takes precedence over doNotAutoAddDefaults, if both are set.
  addAllBuiltIn: false

  include:
    - "privileged-container"
    - "privileged-ports"
    - "run-as-non-root"
    - "cluster-admin-role-binding"
    - "no-liveness-probe"
    - "no-readiness-probe"
    - "unset-cpu-requirements"
    - "unset-memory-requirements"
    - "no-system-group-binding"

customChecks:
  - name: "no-system-group-binding"
    description: "Ensure ClusterRoleBindings do not target system groups"
    remediation: "Remove references to system groups (e.g., system:authenticated, system:unauthenticated) from ClusterRoleBinding subjects"
    template: "cel-expression"
    scope:
      objectKinds:
        - ClusterRoleBinding
    params:
      check: |
        has(object.subjects) && dyn(object.subjects).exists(s, s.kind == "Group" && s.name.startsWith("system:")) 
          ? "ClusterRoleBinding references system group" 
          : ""