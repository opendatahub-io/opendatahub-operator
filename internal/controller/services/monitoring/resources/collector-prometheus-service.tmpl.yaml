# Service for OpenTelemetry Collector Prometheus exporter with TLS support.
# This service is separate from the auto-generated collector service to enable
# TLS via OpenShift's service-ca operator through the serving-cert-secret-name annotation.
# The service-ca operator automatically provisions and rotates TLS certificates for this endpoint.
apiVersion: v1
kind: Service
metadata:
  name: data-science-collector-prometheus
  namespace: {{.Namespace}}
  annotations:
    service.beta.openshift.io/serving-cert-secret-name: data-science-collector-tls
  labels:
    app.kubernetes.io/component: opentelemetry-collector
    app.kubernetes.io/instance: {{.Namespace}}.data-science-collector
    app.kubernetes.io/managed-by: opentelemetry-operator
    app.kubernetes.io/name: data-science-collector-prometheus
    app.kubernetes.io/part-of: opentelemetry
spec:
  ports:
  - name: prometheus
    port: 8889
    protocol: TCP
    targetPort: 8889
  selector:
    app.kubernetes.io/component: opentelemetry-collector
    app.kubernetes.io/instance: {{.Namespace}}.data-science-collector
    app.kubernetes.io/managed-by: opentelemetry-operator
    app.kubernetes.io/part-of: opentelemetry
  type: ClusterIP

